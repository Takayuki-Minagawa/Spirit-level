# Spirit Level - スマホ水平器

スマートフォンの加速度センサーを使った高精度な水平器Webアプリです。

## 特徴

- 📐 **高精度測定**: ±0.1° の精度で傾きを表示
- 🎯 **リアルタイム表示**: 滑らかな気泡アニメーション（グラデーション）
- 📳 **フィードバック**: 水平時にバイブレーション+効果音
- 🔧 **較正機能**: 任意の面を基準に設定可能
- 🌓 **ダーク/ライトテーマ**: 環境に応じて切り替え
- 🌐 **多言語対応**: 日本語/English
- 🔄 **自動センサーチェック**: 同意済みなら再訪問時に自動でセンサーチェック開始

## デモ

https://[username].github.io/Spirit-level/

## 技術スタック

- **フロントエンド**: Vanilla JavaScript (ES6+)
- **センサーAPI**: DeviceMotionEvent (accelerationIncludingGravity)
- **デプロイ**: GitHub Pages
- **CI/CD**: GitHub Actions

## ディレクトリ構成

```
Spirit-level/
├── spirit-level/          # 水平器アプリ
│   ├── index.html         # センサー診断・同意画面
│   ├── favicon.svg        # アイコン
│   ├── app/
│   │   ├── index.html     # 水平器メイン画面
│   │   ├── style.css      # スタイルシート
│   │   ├── sensor.js      # センサー処理
│   │   ├── level.js       # 角度計算・フィルター
│   │   └── app.js         # UIコントローラー
│   └── legal/
│       ├── terms.html     # 利用規約
│       └── privacy.html   # プライバシーポリシー
├── sample/                # 既存：振動計測アプリ
├── index.html             # ルートリダイレクト
└── README.md              # このファイル
```

## ローカル開発

センサーAPIはHTTPS環境が必要です。HTTPSサーバーを起動してください：

```bash
# Python 3の場合
python3 -m http.server 8000

# ブラウザでアクセス
open https://localhost:8000/spirit-level/
```

## 対応環境

| プラットフォーム | サポート |
|---|---|
| iOS Safari | ✅ 完全対応（iOS 13+ 権限必要） |
| Android Chrome | ✅ 完全対応 |
| デスクトップ | ❌ センサー非搭載 |

## 使い方

1. センサーチェック画面で利用規約に同意
2. 「センサーチェック開始」をタップ（同意済みの場合は自動でチェック開始）
3. iOS の場合、モーションセンサーの権限を許可
4. 「水平器画面へ進む」をタップ
5. スマートフォンを水平に置くと、気泡が中心に移動
6. 水平になると「水平です」と表示され、バイブ+音で通知
7. 較正ボタンで任意の面を基準に設定可能

## 技術詳細

### 角度計算

重力加速度ベクトル (gx, gy, gz) から以下の式で角度を計算：

- **ロール角（横方向）**: `atan2(-gx, sqrt(gy² + gz²)) × 180/π`
- **ピッチ角（縦方向）**: `atan2(gy, sqrt(gx² + gz²)) × 180/π`

### ノイズ除去

ローパスフィルター（α = 0.2）でセンサーノイズを低減：

```javascript
filtered = α × current + (1 - α) × previous
```

### 水平判定

ロール角・ピッチ角がともに ±0.5° 以内の場合に「水平」と判定

## ライセンス

MIT License

## 参考

加速度センサーの取得方法は `sample/` フォルダーの振動計測アプリを参考にしています。
